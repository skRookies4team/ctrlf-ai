# AI 개발팀 회의록 - 2025년 12월 12일

> **회의 기간**: 2025-12-12 ~ 2025-12-14
> **작성일**: 2025-12-30
> **작성자**: Claude Code

---

## 1. 회의 개요

12월 12일부터 14일까지는 **Phase 16~19**의 핵심 기능들이 집중적으로 개발된 기간입니다. 퀴즈 자동 생성, 퀴즈 QC 파이프라인, FAQ 초안 생성, 문서 수집(Ingest) API 등 교육 및 지식 관리 관련 핵심 기능들이 구현되었습니다.

---

## 2. 날짜별 작업 내역

### 2.1 12월 12일 (목)

12월 12일은 Phase 16~19의 모든 기능이 한꺼번에 커밋된 날입니다.

---

## 3. Phase별 상세 내용

### 3.1 Phase 16: 퀴즈 자동 생성 API

#### 3.1.1 기능 개요

회사 문서(정책, 교육자료)를 기반으로 퀴즈를 자동 생성하는 API입니다.

```
┌─────────────────────────────────────────────────────────────┐
│                  퀴즈 자동 생성 파이프라인                    │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│  문서 입력                                                   │
│      │                                                      │
│      ▼                                                      │
│  RAG 검색 (관련 청크 추출)                                   │
│      │                                                      │
│      ▼                                                      │
│  LLM 퀴즈 생성                                               │
│      │                                                      │
│      ├──► 객관식 문제 (4지선다)                             │
│      ├──► 참/거짓 문제                                      │
│      └──► 단답형 문제                                       │
│      │                                                      │
│      ▼                                                      │
│  QC 파이프라인 (Phase 17)                                    │
│      │                                                      │
│      ▼                                                      │
│  최종 퀴즈 반환                                              │
│                                                             │
└─────────────────────────────────────────────────────────────┘
```

#### 3.1.2 API 스펙

| 항목 | 내용 |
|------|------|
| 엔드포인트 | `POST /ai/quiz/generate` |
| 요청 본문 | `{ "topic": str, "domain": str, "company_id": int, "count": int, "difficulty": str }` |
| 응답 | `{ "quizzes": List[Quiz], "source_documents": List[str] }` |

#### 3.1.3 퀴즈 유형

| 유형 | 필드 | 설명 |
|------|------|------|
| MULTIPLE_CHOICE | question, options, answer, explanation | 4지선다 객관식 |
| TRUE_FALSE | question, answer, explanation | 참/거짓 |
| SHORT_ANSWER | question, answer, keywords | 단답형 |

#### 3.1.4 난이도 설정

| 난이도 | 설명 |
|--------|------|
| EASY | 문서에 명시된 기본 사실 확인 |
| MEDIUM | 개념 이해 및 적용 필요 |
| HARD | 복합적 사고 및 추론 필요 |

---

### 3.2 Phase 17: 퀴즈 QC 파이프라인

#### 3.2.1 기능 개요

생성된 퀴즈의 품질을 3단계로 검증하는 파이프라인입니다.

```
┌─────────────────────────────────────────────────────────────┐
│                   퀴즈 QC 3단계 파이프라인                    │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│  Stage 1: SCHEMA 검증                                        │
│  ─────────────────────                                       │
│  - 필수 필드 존재 확인                                       │
│  - 데이터 타입 검증                                          │
│  - 선택지 개수 확인 (객관식)                                 │
│                                                             │
│              │ 통과                                         │
│              ▼                                              │
│                                                             │
│  Stage 2: SOURCE 검증                                        │
│  ─────────────────────                                       │
│  - 정답이 원본 문서에 근거하는지 확인                         │
│  - Hallucination 탐지                                       │
│  - 출처 문서 매칭                                            │
│                                                             │
│              │ 통과                                         │
│              ▼                                              │
│                                                             │
│  Stage 3: SELF_CHECK 검증                                    │
│  ─────────────────────                                       │
│  - LLM이 스스로 문제 풀이                                    │
│  - 정답 일치 여부 확인                                       │
│  - 모호한 문제 필터링                                        │
│                                                             │
└─────────────────────────────────────────────────────────────┘
```

#### 3.2.2 검증 결과 처리

| 결과 | 처리 방식 |
|------|----------|
| PASS | 퀴즈 정상 반환 |
| FAIL | 퀴즈 제외 + 실패 사유 로깅 |
| REGENERATE | 해당 퀴즈 재생성 시도 |

#### 3.2.3 QC 통계

| 메트릭 | 설명 |
|--------|------|
| pass_rate | 전체 통과율 |
| schema_fail_rate | Stage 1 실패율 |
| source_fail_rate | Stage 2 실패율 (Hallucination) |
| self_check_fail_rate | Stage 3 실패율 |

---

### 3.3 Phase 18: FAQ 초안 생성 API

#### 3.3.1 기능 개요

회사 문서를 분석하여 자주 묻는 질문(FAQ) 초안을 자동 생성하는 API입니다.

```
┌─────────────────────────────────────────────────────────────┐
│                   FAQ 초안 생성 파이프라인                    │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│  문서 분석                                                   │
│      │                                                      │
│      ▼                                                      │
│  주요 토픽 추출                                              │
│      │                                                      │
│      ▼                                                      │
│  예상 질문 생성 (LLM)                                        │
│      │                                                      │
│      ▼                                                      │
│  RAG 기반 답변 생성                                          │
│      │                                                      │
│      ▼                                                      │
│  FAQ 초안 반환                                               │
│                                                             │
└─────────────────────────────────────────────────────────────┘
```

#### 3.3.2 API 스펙

| 항목 | 내용 |
|------|------|
| 엔드포인트 | `POST /ai/faq/generate` |
| 요청 본문 | `{ "domain": str, "company_id": int, "count": int, "category": str }` |
| 응답 | `{ "faqs": List[FAQ], "topics_analyzed": List[str] }` |

#### 3.3.3 FAQ 모델

```python
class FAQ(BaseModel):
    question: str          # 예상 질문
    answer: str            # RAG 기반 답변
    category: str          # 카테고리 (연차, 급여, 복리후생 등)
    confidence: float      # 답변 신뢰도
    source_documents: List[str]  # 출처 문서
```

#### 3.3.4 카테고리 분류

| 도메인 | 카테고리 예시 |
|--------|-------------|
| POLICY | 연차, 급여, 복리후생, 근무제도, 인사평가 |
| EDUCATION | 신입교육, 직무교육, 리더십, 안전교육 |

---

### 3.4 Phase 19: Document Ingest API 개선

#### 3.4.1 기능 개요

외부 문서를 RAG 시스템에 수집(Ingest)하는 API를 개선했습니다.

#### 3.4.2 주요 개선 사항

| 개선 항목 | 이전 | 이후 |
|----------|------|------|
| 검색 클라이언트 | 직접 RAG 호출 | RagflowSearchClient 추상화 |
| PII 처리 | 없음 | PII 감지 시 블로킹 |
| 에러 처리 | 기본 | 상세 에러 코드 반환 |

#### 3.4.3 RagflowSearchClient 도입

```python
class RagflowSearchClient:
    """
    RAGFlow 검색을 추상화한 클라이언트.

    - 검색 요청 표준화
    - 결과 정규화
    - 재시도 로직 내장
    """

    async def search(
        self,
        query: str,
        top_k: int = 5,
        filters: dict = None
    ) -> SearchResult:
        pass
```

#### 3.4.4 PII 블로킹 기능

| PII 유형 | 처리 방식 |
|----------|----------|
| 주민등록번호 | 인덱싱 거부 + 경고 반환 |
| 전화번호 | 마스킹 후 인덱싱 |
| 이메일 | 마스킹 후 인덱싱 |
| 신용카드번호 | 인덱싱 거부 + 경고 반환 |

---

## 4. 커밋 이력

| 커밋 | 일자 | 내용 |
|------|------|------|
| `9d30aee` | 12/12 | feat: Phase 16-18 기능 추가 및 RAGFlow 연동 개선 |
| `eb7000a` | 12/12 | feat: Add Phase 18 - FAQ 초안 생성 API |
| `be044f3` | 12/12 | feat: Add Phase 19 - Document Ingest API 개선 |

---

## 5. 파일 변경 요약

### 5.1 신규 생성 파일

| 파일 | 설명 |
|------|------|
| `app/api/v1/quiz.py` | 퀴즈 생성 API 라우터 |
| `app/services/quiz_service.py` | 퀴즈 생성 서비스 |
| `app/services/quiz_qc_service.py` | 퀴즈 QC 파이프라인 |
| `app/api/v1/faq_generate.py` | FAQ 생성 API 라우터 |
| `app/services/faq_generation_service.py` | FAQ 생성 서비스 |
| `app/clients/ragflow_search_client.py` | RAGFlow 검색 클라이언트 |
| `app/models/quiz.py` | 퀴즈 Pydantic 모델 |
| `app/models/faq.py` | FAQ Pydantic 모델 |

### 5.2 수정된 파일

| 파일 | 변경 내용 |
|------|----------|
| `app/services/pii_service.py` | 문서 인덱싱 시 PII 블로킹 로직 추가 |
| `app/clients/ragflow_client.py` | 검색 기능 추상화 |
| `app/main.py` | 신규 라우터 등록 |

---

## 6. 테스트 현황

| Phase | 테스트 수 | 상태 |
|-------|----------|------|
| Phase 16 (퀴즈 생성) | 12개 | 전체 통과 |
| Phase 17 (퀴즈 QC) | 15개 | 전체 통과 |
| Phase 18 (FAQ 생성) | 10개 | 전체 통과 |
| Phase 19 (Ingest) | 8개 | 전체 통과 |

---

## 7. 아키텍처 다이어그램

```
┌─────────────────────────────────────────────────────────────┐
│                    Phase 16-19 전체 구조                     │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│  ┌───────────────┐  ┌───────────────┐  ┌───────────────┐   │
│  │ Quiz API      │  │ FAQ API       │  │ Ingest API    │   │
│  │ /ai/quiz      │  │ /ai/faq       │  │ /ai/ingest    │   │
│  └───────┬───────┘  └───────┬───────┘  └───────┬───────┘   │
│          │                  │                  │            │
│          ▼                  ▼                  ▼            │
│  ┌───────────────┐  ┌───────────────┐  ┌───────────────┐   │
│  │ QuizService   │  │ FAQGenService │  │ IngestService │   │
│  └───────┬───────┘  └───────┬───────┘  └───────┬───────┘   │
│          │                  │                  │            │
│          └──────────────────┼──────────────────┘            │
│                             │                               │
│                             ▼                               │
│                  ┌─────────────────────┐                    │
│                  │ RagflowSearchClient │                    │
│                  └──────────┬──────────┘                    │
│                             │                               │
│          ┌──────────────────┼──────────────────┐            │
│          ▼                  ▼                  ▼            │
│  ┌───────────────┐  ┌───────────────┐  ┌───────────────┐   │
│  │   RAGFlow     │  │   LLM         │  │  PII Service  │   │
│  │   (검색)      │  │   (생성)      │  │  (마스킹)     │   │
│  └───────────────┘  └───────────────┘  └───────────────┘   │
│                                                             │
└─────────────────────────────────────────────────────────────┘
```

---

## 8. 기술적 고려사항

### 8.1 퀴즈 생성 품질

| 고려사항 | 대응 방안 |
|----------|----------|
| Hallucination | 3단계 QC로 필터링 |
| 난이도 불균형 | 난이도별 프롬프트 차별화 |
| 중복 문제 | 유사도 검사로 중복 제거 |

### 8.2 FAQ 생성 품질

| 고려사항 | 대응 방안 |
|----------|----------|
| 질문 자연스러움 | 실제 질문 패턴 학습 |
| 답변 정확성 | RAG 기반 + 출처 명시 |
| 카테고리 분류 | 도메인별 카테고리 사전 정의 |

### 8.3 PII 처리

| 고려사항 | 대응 방안 |
|----------|----------|
| 민감정보 노출 | 인덱싱 전 PII 검사 |
| 오탐지 | 화이트리스트 관리 |
| 성능 | 비동기 PII 검사 |

---

## 9. 참고 사항

### 9.1 12월 13일 (금), 14일 (토)

- 주말로 인해 별도 커밋 없음
- Phase 16-19 기능 테스트 및 안정화 기간

### 9.2 의존성

| 패키지 | 용도 |
|--------|------|
| `httpx` | 비동기 HTTP 클라이언트 |
| `pydantic` | 데이터 검증 |
| `asyncio` | 비동기 처리 |

---

## 10. 다음 작업 예정

| 우선순위 | 작업 항목 | 담당 |
|---------|----------|------|
| 높음 | Phase 20: 채팅 히스토리 관리 | AI팀 |
| 높음 | 퀴즈 QC 통계 대시보드 | AI팀 |
| 중간 | FAQ 카테고리 자동 분류 고도화 | AI팀 |

---

## 11. 회의 결론

### 11.1 성과 요약

| 항목 | 내용 |
|------|------|
| 완료 Phase | Phase 16, 17, 18, 19 |
| 신규 API | 퀴즈 생성, FAQ 생성, Ingest 개선 |
| 핵심 기능 | 퀴즈 자동 생성 + 3단계 QC, FAQ 초안 생성 |

### 11.2 핵심 구현 내용

1. **Phase 16**: 문서 기반 퀴즈 자동 생성 (객관식, 참/거짓, 단답형)
2. **Phase 17**: 3단계 QC 파이프라인 (SCHEMA → SOURCE → SELF_CHECK)
3. **Phase 18**: 문서 분석 기반 FAQ 초안 자동 생성
4. **Phase 19**: RagflowSearchClient 도입 + PII 블로킹

### 11.3 품질 관리

- 퀴즈 QC 파이프라인으로 Hallucination 방지
- PII 블로킹으로 민감정보 보호
- 출처 문서 명시로 답변 신뢰성 확보

---

**회의록 종료**
