# =============================================================================
# Fluent Bit Parsers Configuration for ctrlf-ai
# =============================================================================

# Docker container log format
[PARSER]
    Name        docker
    Format      json
    Time_Key    time
    Time_Format %Y-%m-%dT%H:%M:%S.%L
    Time_Keep   On

# JSON parser for application logs
[PARSER]
    Name        json
    Format      json
    Time_Key    timestamp
    Time_Format %Y-%m-%dT%H:%M:%S.%L%z
    Time_Keep   On

# Python/FastAPI log format
[PARSER]
    Name        python
    Format      regex
    Regex       ^(?<timestamp>\d{4}-\d{2}-\d{2} \d{2}:\d{2}:\d{2},\d{3}) - (?<logger>[^ ]+) - (?<level>[A-Z]+) - (?<message>.*)$
    Time_Key    timestamp
    Time_Format %Y-%m-%d %H:%M:%S,%L
    Time_Keep   On

# Uvicorn access log format
[PARSER]
    Name        uvicorn
    Format      regex
    Regex       ^(?<client_ip>[^ ]+) - "(?<method>[A-Z]+) (?<path>[^ ]+) HTTP/[0-9.]+" (?<status>\d+)$
    Time_Keep   Off
